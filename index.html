<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CromeCast Connect</title>
</head>

<center><i><b>Welcome to the jungle. We have fun and games.</b></i></center>
<p></p>
	
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
	
<script src="https://www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js"></script>
<script src="build/pdf.js"></script>
<script src="compatibility.js"></script>	
<script src="getPDF.js"></script>
<script src="canvasLaser.js"></script>
<script src="canvasDraw.js"></script>
<script src="commandParse.js"></script>
	
<script type="text/javascript">
    var channel = "urn:x-cast:com.example.chrome_send_world_2";
	
	 function log(str){
	    console.log(str);
	    
	    var newSpan = document.createElement("span");
	    var newContent = document.createTextNode(str);
	    newSpan.appendChild(newContent);
	    
	    var root = document.getElementById("root");
	    root.appendChild(newSpan);
	    root.appendChild(document.createElement("br"));
    }
	
	function onSenderConnected(event){
		log("onChannelOpened. Total number of channels: " + window.castReceiverManager.getSenders().length);
		var string = "onChannelOpened. Total number of channels: " + window.castReceiverManager.getSenders().length;
		document.getElementById("Conexao").innerHTML = string.toString();
	}
	
	function onSenderDisconnected(event){
		log("onChannelClosed. Total number of channels: " + window.castReceiverManager.getSenders().length);
		if (window.castReceiverManager.getSenders().length == 0) window.close();
	}
	
	function onError(){
		log("onError");
	}
	
	function onMessage(event){
		var message = event.data;
		whatCommand(message);	
	}
	
	function onLoadCast(){
		window.castReceiverManager = cast.receiver.CastReceiverManager.getInstance();
		window.castReceiverManager.onSenderConnected = onSenderConnected;
		window.castReceiverManager.onSenderDisconnected = onSenderDisconnected;
		
		window.customMessageBus = window.castReceiverManager.getCastMessageBus(channel);
		window.customMessageBus.onMessage = onMessage;
		
		window.castReceiverManager.start();
	}
	
	function broadcast(message){
		window.customMessageBus.broadcast(message);
	}
	
	window.addEventListener("load", onLoadCast);
</script>

<body>
	
<output id="Conexao" style="float: right;"></output>
<p><\p>
<div id="root" style="float: right;">
        chromecast demo<br>
</div>	
<div style="position: relative; width:800px; margin:0 auto;">
        <canvas id="canvasPDF"  style="position: absolute; left: 0; top: 0; z-index: 0; border:1px  solid white"></canvas>
        <canvas id="canvasDraw" style="position: absolute; left: 0; top: 0; z-index: 1; border:1px  solid white"></canvas>
        <canvas id="canvasPointer" style="position: absolute; left: 0; top: 0; z-index: 2; border:1px  solid white"></canvas>
</div>

</body>

</html>
